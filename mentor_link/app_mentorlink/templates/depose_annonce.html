{% extends "base.html" %}

{% block title %}Mentorlink - Déposer une annonce{% endblock %}

{% block content %}
<h1>Déposer une annonce</h1>

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    <!-- Champ Prix (supposé être un champ texte ou nombre) -->
    <div>
        <input type="id_prix" name="prix" id="id_prix" maxlength="20" step="any" min="0" />{% if form.prix.errors %}
        <div class="error">
        {{ form.prix.errors }}</div>
        {% endif %}
        <div id="compteur_prix">0 / 20 caractères</div>
    </div>

    <!-- Champ Image (pas de compteur, généralement fichier) -->
    <div>
        {{ form.image.label_tag }}
        {{ form.image }}
        {% if form.image.errors %}
            <div class="error">{{ form.image.errors }}</div>
        {% endif %}
    </div>

    <!-- Champ Métier -->
    <div>
        <label for="id_metier">Metier</label>
        <textarea name="metier" id="id_metier" maxlength="50" rows="5" cols="40"></textarea>
        {% if form.metier.errors %}
            <div class="error">{{ form.metier.errors }}</div>
        {% endif %}
        <div id="compteur_metier">0 / 50 caractères</div>
    </div>

    <!-- Champ Adresse -->
    <div>
        <label for="id_adresse">Adresse</label>
        <textarea name="adresse" id="id_adresse" maxlength="100" rows="5" cols="40"></textarea>
        {% if form.adresse.errors %}
            <div class="error">{{ form.adresse.errors }}</div>
        {% endif %}
        <div id="compteur_adresse">0 / 100 caractères</div>
    </div>


    <!-- Champ Description -->
    <div>
        <label for="id_description">Description</label>
        <textarea name="description" id="id_description" maxlength="500" rows="5" cols="40"></textarea>
        {% if form.description.errors %}
            <div class="error">{{ form.description.errors }}</div>
        {% endif %}
        <div id="compteur_description">0 / 500 caractères</div>
    </div>

    <button type="submit">Déposer l'annonce</button>
</form>

<script>
    // Fonction pour mettre à jour un compteur de caractères
    function setCompteur(inputId, compteurId, max) {
        const input = document.getElementById(inputId);
        const compteur = document.getElementById(compteurId);
        function update() {
            compteur.textContent = input.value.length + " / " + max + " caractères";
        }
        input.addEventListener('input', update);
        update();
    }

    // Initialisation des compteurs pour chaque champ texte
    // Adaptez les IDs selon vos champs générés par Django si besoin
    setCompteur('id_prix', 'compteur_prix', 20);           // Limite à adapter selon votre modèle
    setCompteur('id_metier', 'compteur_metier', 50);
    setCompteur('id_adresse', 'compteur_adresse', 100);
    setCompteur('id_description', 'compteur_description', 500);
</script>
{% endblock %}
